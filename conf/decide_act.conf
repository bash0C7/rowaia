# Decision phase - reading processed context
<source>
  @type context
  path /tmp/fluentd/context
  tag decision
  run_interval 1800s
</source>

# Decision phase - triaging information with LLM
<filter decision>
  @type llm_generate
  model_name hf.co/elyza/Llama-3-ELYZA-JP-8B-GGUF:latest
  api_url http://localhost:11434/api
  prompt Below is information from various sources that needs to be triaged.\n<%= record["message"] %>\nPlease categorize the priority as:\n1:red - Critical and requires immediate attention\n2:yellow - Important but not time-sensitive\n3:green - Normal priority, handle as scheduled\n4:black - Low priority or informational only\nExplain your reasoning for this categorization and provide specific next actions.
</filter>

# Action phase - sending notifications
<match decision>
  @type sstp
  sstp_server 127.0.0.1
  sstp_port 9801
  request_method NOTIFY
  request_version SSTP/1.1
  sender Rowaia
  option nodescript,notranslate
  script_template \h\s[8]<%= record["llm_output"] %> \uHow would you like to proceed?\e

  <buffer>
    @type memory
    flush_mode immediate
  </buffer>
</match>
